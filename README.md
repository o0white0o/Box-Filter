## Box-Filter
#### Дано:
1. Усредняющий фильтр с апертурой 5х5

![alt-текст](https://pp.userapi.com/c848536/v848536008/738d7/uV9iV-N-cwc.jpg "апертура")

2. Исходная картинка: 8bit, graescale
#### Требуется:
1. Оценить вычислительную сложность операции применения к изображению размера NxM усредняющего фильтра F
2. Реализовать на языке C  функцию, реализующую алгоритм впрямую.
3. Предложить способ оптимизации функции по количеству операций

#### Теория:
Box-Filter (также известное как box linear filter) представляет из себя пространственный домен линейного фильтр , в котором каждый пиксель выходного изображении имеет значение, равное среднему значению соседних пикселей на входном изображении.

Пример применения фильтра:

![alt-текст](https://www.tutorialspoint.com/opencv/images/filter_input.jpg "Исходное изображение")
![alt-текст](https://www.tutorialspoint.com/opencv/images/box_filter.jpg "Результирующие изображение")

#### Ход работы:
**Оценка вычислительной сложности алгоритма:** (Не учитывая краевые эффекты)

Box-Filter имеет сложность O(N * M * nF *nF), 

где NxM – размер изображения;

nF – размер усредняющего фильтра.

Для оптимизации предлагается использовать вместо квадратной матрицы две одномерные и выполнять в два прохода:

|1|1|1|1|1| 
|--|--|--|--|--|

и

|1| 
|--|
|1|
|1|
|1|
|1|

Вычислительная сложность данного алгоритма:
O(N * M * nF) + O(N * M * nF) = 2*O(N * M * nF)
данный алгоритм будет работать быстрее для всех nF >=3

#### Начальные условия:
1. [OpenCV](https://docs.opencv.org/3.3.0/d7/d9f/tutorial_linux_install.html)

#### Запуск проекта:
1. Выполнить скрипт ./build.sh
2. В конфигурационном файле (config.yml) задать имя входного/выходного изображения и размер фильтра

по умолчанию: 
```yaml
image_name: ../src/Image0.jpg
output_name: ../src/Image0_output.jpg
kernel_size: 5
optimization: 0 # 0 - прямой метод, 1 - оптимизированный алгоритм
```
3. Запуск проекта из директории /bin
```yaml
./Box_Filter Путь_до_конфиг_файла/NAME_CONFIG_FILE.yml
или
./Box_Filter 
```
При втором варианте - конфиг файл ../config/config.yml

#### Результаты:

![alt-текст](https://pp.userapi.com/c830208/v830208207/1a1000/4srdV-eDwmE.jpg "Исходное изображение")

Размер исходного изображения 800х536

| Полученное изображение| Размер фильтра |Прямой метод|Оптимизированный метод| 
|---------------------| --------------|--------------|------------------------|
|![alt-текст](https://pp.userapi.com/c830208/v830208207/1a1010/5wUrWcNstdk.jpg "3х3")|3х3|CPU time used = 0.044874|CPU time used = 0.036661|
|![alt-текст](https://pp.userapi.com/c830208/v830208207/1a1008/4nhroKD43Mc.jpg "5х5")|5х5|CPU time used = 0.113775|CPU time used = 0.055356|
|![alt-текст](https://pp.userapi.com/c830208/v830208207/1a1018/Q9At_edhl2s.jpg "7х7")|7x7|CPU time used = 0.208535|CPU time used = 0.065508|


![alt-текст](https://pp.userapi.com/c848532/v848532871/7deeb/thXA981hIu8.jpg "Исходное изображение")

Размер исходного изображения 450х450

| Полученное изображение| Размер фильтра |Прямой метод|Оптимизированный метод| 
|---------------------| --------------|--------------|------------------------|
|![alt-текст](https://pp.userapi.com/c848532/v848532871/7df05/TwRqkup7m5I.jpg "3х3")|3х3|CPU time used = 0.024380|CPU time used = 0.023956|
|![alt-текст](https://pp.userapi.com/c848532/v848532871/7df0c/eSUu0Vo4VhU.jpg "5х5")|5х5|CPU time used = 0.059024|CPU time used = 0.036567|
|![alt-текст](https://pp.userapi.com/c848532/v848532871/7df13/damoomYp7oE.jpg "7х7")|7x7|CPU time used = 0.116621|CPU time used = 0.038256|




#### Литература: 
1. https://tproger.ru/articles/computational-complexity-explained/
2. https://en.wikipedia.org/wiki/Box_blur
3. https://docs.opencv.org/3.3.0/index.html
